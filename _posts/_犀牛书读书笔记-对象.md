---
title: 犀牛书读书笔记-对象
date: 2016-02-15
categories: javascript
tags: ["javascript", "读书笔记"]
---

<!-- more -->

1. 对象可被看作是字符串到值的映射，多种叫法如散列、散列表、字典、关联数组
2. 可从一个称为原型的对象继承属性，通常用来继承对象的方法。
3. 结合3.7节`不可变的原始值`和`可变的对象引用`
4. 三类对象：
    - 内置对象(native object)
    - 宿主对象(host object) 如HTMLElement对象
    - 自定义对象(user-defined object)

## `Object.create()`
### 简易polyfil
当中为什么不能实现原型对象为null，即不会继承任何属性和方法，包括toString()

```javascript
function F(){}
undefined

F.prototype = null
null

var child = new F()
undefined

child.toString()
"[object Object]"

child.constructor
Object() { [native code] }
```
### 另一个用途是用来防止库函数无意间修改那些不受你控制的对象。
当添加同名属性或方法时，也只是同名属性方法在对象原型链上的覆盖。

```javascript
var o = {x: "don't change this value"};
library_func(Obejct.create(o)); // 防止对o的意外修改
```
## 属性访问错误
对象不存在，那么查询这个不存在的对象的属性就会报错。两种容错处理

```javascript
var len = undefined;
if (book) {
    if (book.subtitle) len = book.subtitle.length;
}

// &&短路操作
var len = book && book.subtitle && book.subtitle.length;
```
### 严格模式中，以下属性赋值会失败
1. `obj`中的属性`p`是只读的，只读属性不能被重新赋值
但是在`defineProperty()`方法中，可以对**可配置**的**只读**属性重新赋值
2. `obj`中的属性`p`是继承来的，且为只读：不能通过**同名自有属性**覆盖**只读的继承属性**
3. `obj`不存在自有属性`p`,没有使用`setter`方法继承属性`p`，且`obj`的可扩展特性`extensible attribute`是`false`。？？

## 删除属性`delete`
### delete只是断开属性与宿主对象的联系，而不会去操作属性中的属性
```javascript
var a = {
    p: {x: 1}
};
var b = a.p;
delete a.p;
// 已经删除的属性的引用依然存在
console.log(b.x); // 依然是1
```
这可能会导致内存泄漏，所以在销毁对象的时候，要遍历属性中的属性，依次删除。

### delete不能删除`configurable: false`的属性
某些内置对象的属性是不可配置的，如通过函数声明和`var`声明创建的全局对象的属性。

```javascript
// 严格模式报错，非严格返回false

delete Object.prototype;

var x = 1;
delete this.x; // 删不掉

window.x = 1; // or x = 1;
delete this.x; // 返回TRUE 删得掉

function f() {}
delete this.f; // 删不掉
```
## 检测属性
返回值均为`true` `false`
| 方法 | 区别 | 
| ------------- | ------------- |
| in运算符 | 自有属性与继承属性 |
| hasOwnProperty | 仅自有属性 |
| propertyIsEnumerble | 自有属性且可枚举 |

### 还可以通过`!==`判断

```javascript
var o = {x: 1};
o.x !== undefined; // true 有这个属性

o.y = undefined; // 当显式设置了undefined时，失效
o.y !== undefined; // false
"y" in o // true

// 注意这里用的是!== 
// !==可以用于区分undefined 和 null
undefined != null // false
undefined !== null // true
```


## 属性特性与对象特性
### 属性特性(property attribute)
可写writable 可枚举enumerable 可配置configurable

### 对象特性(object attribute)
对象的原型 对象的类 对象的扩展标记
